generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String    @id @default(uuid())
  email         String    @unique
  password      String
  name          String
  age           Int?
  height        Int?
  weight        Float?
  sex           String?
  activityLevel String?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  foods         Food[]
  meals         Meal[]
  routines      Routine[]
  plans         Plan[]
}

model Plan {
  id        String         @id @default(uuid())
  name      String
  goal      String
  startDate DateTime
  endDate   DateTime
  userId    String
  routines  DailyRoutine[]
  user      User           @relation(fields: [userId], references: [id])
}

model DailyRoutine {
  id                 String      @id @default(uuid())
  name               String
  date               DateTime
  status             Status      @default(PENDING)
  water              Int         @default(0)
  totalCalories      Float       @default(0)
  totalCarbohydrates Float       @default(0)
  totalProteins      Float       @default(0)
  totalFats          Float       @default(0)
  totalSodiums       Float       @default(0)
  totalFibers        Float       @default(0)
  planId             String
  plan               Plan        @relation(fields: [planId], references: [id])
  meals              DailyMeal[]
}

model DailyMeal {
  id                 String          @id @default(uuid())
  name               String
  time               String
  status             Status          @default(PENDING)
  totalCalories      Float           @default(0)
  totalCarbohydrates Float           @default(0)
  totalProteins      Float           @default(0)
  totalFats          Float           @default(0)
  totalSodiums       Float           @default(0)
  totalFibers        Float           @default(0)
  routineId          String
  routine            DailyRoutine    @relation(fields: [routineId], references: [id])
  foods              DailyMealFood[]
}

model DailyMealFood {
  id            String    @id @default(uuid())
  name          String
  unit          Unit      @default(GRAMS)
  quantity      Float
  calories      Float
  carbohydrates Float
  proteins      Float
  fats          Float
  sodiums       Float
  fibers        Float
  mealId        String
  meal          DailyMeal @relation(fields: [mealId], references: [id])
}

model Routine {
  id                 String        @id @default(uuid())
  name               String
  water              Int           @default(0)
  totalCalories      Float         @default(0)
  totalCarbohydrates Float         @default(0)
  totalProteins      Float         @default(0)
  totalFats          Float         @default(0)
  totalSodiums       Float         @default(0)
  totalFibers        Float         @default(0)
  userId             String
  User               User          @relation(fields: [userId], references: [id])
  meals              RoutineMeal[]
}

model RoutineMeal {
  routineId String
  mealId    String
  time      String
  routine   Routine @relation(fields: [routineId], references: [id])
  meal      Meal    @relation(fields: [mealId], references: [id])

  @@id([routineId, mealId, time])
}

model Meal {
  id                 String        @id @default(uuid())
  name               String
  totalCalories      Float         @default(0)
  totalCarbohydrates Float         @default(0)
  totalProteins      Float         @default(0)
  totalFats          Float         @default(0)
  totalSodiums       Float         @default(0)
  totalFibers        Float         @default(0)
  userId             String
  User               User          @relation(fields: [userId], references: [id])
  routines           RoutineMeal[]
  foods              MealFood[]
}

model MealFood {
  mealId   String
  foodId   String
  quantity Float
  meal     Meal   @relation(fields: [mealId], references: [id])
  food     Food   @relation(fields: [foodId], references: [id])

  @@id([mealId, foodId])
}

model Food {
  id            String     @id @default(uuid())
  name          String
  unit          Unit       @default(GRAMS)
  calories      Float
  carbohydrates Float
  proteins      Float
  fats          Float
  sodiums       Float
  fibers        Float
  userId        String
  User          User       @relation(fields: [userId], references: [id])
  meals         MealFood[]
}

enum Status {
  PENDING
  COMPLETED
  MISSED
}

enum Unit {
  GRAMS
  MILILITERS
}
